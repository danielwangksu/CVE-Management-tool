def parse_record(filename):
    group_patch = []
    group_unpatch = []
    dictList = {}
    i = 0
    with open(filename, "r") as f:
        content = f.readlines()[2:]
        for item in content:
            if item == "\n":
                i += 1
                if dictList['CVE STATUS'] == "Patched":
                    group_patch.append(dictList)
                if dictList['CVE STATUS'] == "Unpatched":
                    group_unpatch.append(dictList)
                dictList = {}
            if item != "\n":
                key, value = item.split(':', 1)
                key = key.lstrip().rstrip()
                value = value.lstrip().rstrip()
                dictList[key] = value
    return  group_patch, group_unpatch

def disassemble_cve_object(cves):
    output = []
    i = 0
    for cve in cves:
        dictList = {}
        dictList['id'] = cve.id
        dictList['cvssv2'] = cve.scorev2
        dictList['package'] = cve.package
        dictList['version'] = cve.version
        dictList['cve'] = cve.cve_record
        dictList['vector'] = cve.vector
        dictList['summary'] = cve.description
        dictList['detail'] = cve.link
        dictList['status'] = cve.status
        output.append(dictList)
    return output

